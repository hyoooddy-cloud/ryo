<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ì•„ì´ëŒ ë ˆì¼ 5ë¸”ëŸ­ | ë ˆì „ë“œ vs ì•„ì´ì½˜</title>

<!-- ê³µìœ ìš© ë©”íƒ€ (ë°°í¬ í›„ og:imageì— ì‹¤ì œ ì´ë¯¸ì§€ URLë¡œ êµì²´ ì¶”ì²œ) -->
<meta property="og:title" content="ì•„ì´ëŒ ë ˆì¼ 5ë¸”ëŸ­ ê²Œì„" />
<meta property="og:description" content="3ë²ˆì§¸ ë¸”ëŸ­ì´ ë ˆì „ë“œ(7ë…„â†‘)ì¸ì§€ ì•„ì´ì½˜(7ë…„â†“)ì¸ì§€ ë§í˜€ë¼!" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://example.com/og-thumbnail.png" />

<style>
  :root{
    --bg:#0b0e17;
    --panel:#14182a;
    --card:#11162a;
    --line:#22284a;
    --legend:#7b61ff;
    --icon:#2fd3ff;
    --text:#ffffff;
    --muted:rgba(255,255,255,.72);

    --slotH:58px;
    --gap:10px;
    --shift: calc(var(--slotH) + var(--gap));
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
    display:flex; justify-content:center; align-items:center;
    padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
  }
  .app{ width:100%; max-width:520px; padding:18px; }

  /* ë¡œë”©(í˜ì´ì§€ ì—´ìë§ˆì) */
  .boot{
    position:fixed; inset:0; z-index:9999;
    display:flex; align-items:center; justify-content:center;
    background: radial-gradient(1200px 500px at 50% 0%, rgba(47,211,255,.14), transparent 60%),
                radial-gradient(900px 500px at 50% 100%, rgba(123,97,255,.14), transparent 60%),
                var(--bg);
    transition: opacity .25s ease;
  }
  .boot.off{ opacity:0; pointer-events:none; }
  .bootCard{
    width:min(420px, 88vw);
    background:rgba(20,24,42,.75);
    border:1px solid var(--line);
    border-radius:18px;
    padding:18px;
    text-align:center;
    box-shadow: 0 24px 70px rgba(0,0,0,.45);
  }
  .bootTitle{ font-weight:900; font-size:16px; }
  .bootSub{ margin-top:6px; font-size:12px; color:var(--muted); line-height:1.45; }
  .spinner{
    width:34px; height:34px; margin:14px auto 0;
    border-radius:999px;
    border:3px solid rgba(255,255,255,.18);
    border-top-color: rgba(255,255,255,.8);
    animation: spin .8s linear infinite;
  }
  @keyframes spin{ to{ transform:rotate(360deg) } }

  /* ìƒë‹¨ ìŠ¤ì½”ì–´ */
  .top{ display:flex; gap:10px; margin-bottom:12px; }
  .box{
    flex:1; background:var(--panel);
    padding:10px 14px; border-radius:14px; text-align:center;
    border:1px solid rgba(255,255,255,.06);
  }
  .box span{ display:block; font-size:12px; opacity:.75; }
  .box b{ font-size:20px; display:inline-block; }

  /* ì½¤ë³´ ì—°ì¶œ */
  .comboPulse{ animation: comboPulse .22s ease-out; }
  @keyframes comboPulse{ 0%{transform:scale(1)} 55%{transform:scale(1.28)} 100%{transform:scale(1)} }
  .box.hot{ box-shadow: 0 0 0 2px rgba(255,255,255,.10) inset, 0 0 26px rgba(47,211,255,.22); }
  .box.hot b{ text-shadow: 0 0 12px rgba(47,211,255,.55); }

  .panel{
    background:rgba(17,22,42,.6);
    border:1px solid var(--line);
    border-radius:18px;
    padding:14px;
  }
  .titleRow{ display:flex; justify-content:space-between; align-items:baseline; gap:10px; }
  .title{ font-weight:900; font-size:16px; }
  .sub{ font-size:12px; color:var(--muted); }

  /* ë ˆì¼ */
  .railWrap{
    margin-top:12px;
    background:rgba(20,24,42,.55);
    border:1px solid var(--line);
    border-radius:18px;
    padding:12px;
    overflow:hidden;
    position:relative;
  }
  /* ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ ì‚¬ë¼ì§€ëŠ” ê·¸ë¼ë°ì´ì…˜ */
  .railWrap::after{
    content:"";
    position:absolute; left:0; right:0; bottom:0;
    height:42%;
    pointer-events:none;
    background: linear-gradient(to bottom,
      rgba(11,14,23,0) 0%,
      rgba(11,14,23,.25) 35%,
      rgba(11,14,23,.55) 70%,
      rgba(11,14,23,.9) 100%
    );
  }
  .slots{
    position:relative;
    display:flex;
    flex-direction:column;
    gap:var(--gap);
    will-change: transform;
  }
  .block{
    height:var(--slotH);
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    background:var(--card);
    border:1px solid var(--line);
    border-radius:14px;
    padding:0 10px;
    font-weight:900;
    font-size:15px;
    line-height:1.15;
    user-select:none;
    will-change: transform;
    position:relative;
  }

  .bName{ font-weight:900; font-size:15px; line-height:1.1; }
  .block.selected .bName{ font-size:17px; }
  .bGroup{ margin-top:2px; font-size:11px; font-weight:800; opacity:.72; letter-spacing:-.01em; }


  /* í˜„ì¬ ë¬¸ì œ: 3ë²ˆì§¸ ì¹¸ ê°•ì¡° */
  .block.selected{
    font-size:17px;
    transform: scale(1.06);
    border-color: rgba(255,255,255,.45);
    box-shadow: 0 0 0 2px rgba(255,255,255,.18) inset, 0 10px 26px rgba(0,0,0,.45);
  }
  .block.selected::after{
    content:"ì§€ê¸ˆ ë§ì¶”ëŠ” ë¸”ëŸ­";
    position:absolute;
    right:10px;
    top:8px;
    font-size:11px;
    font-weight:800;
    opacity:.8;
  }

  /* ì§€ë‚˜ê°„ ë¬¸ì œ(ì„ íƒì¹¸ ì•„ë˜) */
  .block.past{
    opacity:.42;
    filter:saturate(.75);
    background: rgba(17,22,42,.78);
  }
  .block.past::after{
    content:"PASSED";
    position:absolute;
    left:10px;
    bottom:6px;
    font-size:10px;
    font-weight:800;
    letter-spacing:.08em;
    opacity:.60;
  }

  /* ìƒˆë¡œ ë“¤ì–´ì˜¤ëŠ” ë§¨ ìœ„ */
  .block.enter{
    opacity:0;
    transform: translateY(-10px);
  }
  .block.enter.enterOn{
    opacity:1;
    transform: translateY(0);
  }

  .hint{
    margin-top:10px;
    text-align:center;
    font-size:13px;
    color:var(--muted);
    min-height:20px;
  }

  /* ì•¡ì…˜ ì˜ì—­ */
  .actions{ margin-top:12px; }
  .startOnly button{
    width:100%;
    padding:12px;
    border-radius:16px;
    border:1px solid #2a3158;
    background:#22284a;
    color:#fff;
    font-weight:900;
    cursor:pointer;
  }
  .buttons{ display:flex; gap:10px; }
  .btnCol{ flex:1; display:flex; flex-direction:column; gap:6px; }
  .btnNote{ text-align:center; font-size:11px; opacity:.75; }
  button.action{
    width:100%;
    padding:14px 12px;
    border-radius:16px;
    border:none;
    font-weight:900;
    cursor:pointer;
    touch-action: manipulation;
  }
  .btnLegend{ background:var(--legend); color:#fff; }
  .btnIcon{ background:var(--icon); color:#001018; }
  button:disabled{ opacity:.55; cursor:not-allowed; }

  .row{ margin-top:12px; display:flex; gap:10px; }
  .ghost{
    flex:1;
    padding:12px;
    border-radius:16px;
    border:1px solid #2a3158;
    background:#1a203d;
    color:#fff;
    font-weight:900;
    cursor:pointer;
  }

  /* ê²°ê³¼ */
  .result{
    margin-top:12px;
    background:#0f1426;
    border:1px solid var(--line);
    border-radius:16px;
    padding:12px;
    display:none;
  }
  .result h3{ margin:0 0 6px; font-size:15px; }
  .rtype{ font-weight:900; font-size:18px; margin:4px 0; }
  .rdesc{ font-size:13px; opacity:.88; line-height:1.45; }
  .rmeta{ font-size:12px; opacity:.8; margin-top:8px; line-height:1.5; }
  .shareBox{
    margin-top:10px;
    background:#10193a;
    border:1px solid #22306a;
    border-radius:12px;
    padding:10px;
    font-size:12px;
    white-space:pre-wrap;
  }

  .kbd{ margin-top:10px; text-align:center; font-size:12px; opacity:.65; }

  @media (max-width:420px){
    .app{ padding:14px; }
    .title{ font-size:17px; }
    .box b{ font-size:19px; }
    button.action{ padding:16px 12px; }
  }
</style>
</head>
<body>

<div class="boot" id="boot">
  <div class="bootCard">
    <div class="bootTitle">ì•„ì´ëŒ ë ˆì¼ 5ë¸”ëŸ­</div>
    <div class="bootSub">ë” ì»¤ì§„ ê·œëª¨, ê¸¸ì–´ì§„ ì—­ì‚¬!<br/>ìƒˆë¡œì›Œì§„ ìµœì• ëŒ ë¦¬ê·¸ í•œë²ˆì— íŒŒì•…í•˜ê¸°!</div>
    <div class="spinner" aria-hidden="true"></div>
  </div>
</div>

<div class="app">
  <div class="top">
    <div class="box"><span>SCORE</span><b id="score">0</b></div>
    <div class="box" id="comboBox"><span>COMBO</span><b id="combo">0</b></div>
    <div class="box"><span>TIME</span><b id="time">60</b></div>
  </div>

  <div class="panel">
    <div class="titleRow">
      <div class="title">ì•„ì´ëŒ ë ˆì¼ 5ë¸”ëŸ­</div>
      <div class="sub">3ë²ˆì§¸ ë¸”ëŸ­ì´ ë ˆì „ë“œ(7ë…„â†‘)ì¸ì§€ ì•„ì´ì½˜(7ë…„â†“)ì¸ì§€ ë§íˆê¸°</div>
    </div>

    <div class="railWrap">
      <div class="sub" style="margin-bottom:8px;">
        ë” ì»¤ì§„ ê·œëª¨, ê¸¸ì–´ì§„ ì—­ì‚¬!<br/>ìƒˆë¡œì›Œì§„ ìµœì• ëŒ ë¦¬ê·¸ í•œë²ˆì— íŒŒì•…í•˜ê¸°!
      </div>
      <div class="slots" id="slots"></div>
    </div>

    <div class="hint" id="hint"></div>

    <div class="actions">
      <div class="startOnly" id="startOnly">
        <button id="btnStart">START</button>
      </div>

      <div class="buttons" id="answerButtons" style="display:none;">
        <div class="btnCol">
          <button class="action btnLegend" id="btnLegend">ğŸ† ë ˆì „ë“œ</button>
          <div class="btnNote">ë°ë·” 7ë…„ ì´ìƒ</div>
        </div>
        <div class="btnCol">
          <button class="action btnIcon" id="btnIcon">â­ ì•„ì´ì½˜</button>
          <div class="btnNote">ë°ë·” 7ë…„ ì´í•˜</div>
        </div>
      </div>

      <div class="row">
        <button class="ghost" id="btnCopy" disabled>ê³µìœ ë¬¸êµ¬ ë³µì‚¬</button>
        <button class="ghost" id="btnReset" disabled>ë¦¬ì…‹</button>
      </div>
    </div>

    <div class="result" id="result">
      <h3>ê²°ê³¼</h3>
      <div class="rtype" id="rtype">-</div>
      <div class="rdesc" id="rdesc">-</div>
      <div class="rmeta" id="rmeta">-</div>
      <div class="shareBox" id="shareText"></div>
    </div>

    <div class="kbd">PC: â† = ë ˆì „ë“œ / â†’ = ì•„ì´ì½˜ Â· ëª¨ë°”ì¼: ë²„íŠ¼ í„°ì¹˜</div>
  </div>
</div>

<script>
  // ===== ì„¤ì • =====
  const CURRENT_YEAR = 2026;
  const GAME_TIME = 60;
  const VISIBLE_COUNT = 5;
  const ACTIVE_INDEX = 2; // 3ë²ˆì§¸ ì¹¸

  // ===== ì•„ì´ëŒ ë°ì´í„°(Top100 í™•ì¥) =====
    const IDOLS = [
    // ë°©íƒ„ì†Œë…„ë‹¨(BTS) / HYBE
    { name:"RM", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ì§„", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ìŠˆê°€", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ì œì´í™‰", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ì§€ë¯¼", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ë·”", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },
    { name:"ì •êµ­", group:"ë°©íƒ„ì†Œë…„ë‹¨", debut:2013 },

    { name:"ì—°ì¤€", group:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },
    { name:"ìˆ˜ë¹ˆ", group:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },
    { name:"ë²”ê·œ", group:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },
    { name:"íƒœí˜„", group:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },
    { name:"íœ´ë‹ì¹´ì´", group:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },

    { name:"ë‹ˆí‚¤", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"í¬ìŠ¹", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"ì œì´", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"ì œì´í¬", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"ì„±í›ˆ", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"ì„ ìš°", group:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"ì •ì›", group:"ì—”í•˜ì´í”ˆ", debut:2020 },

    // SM
    { name:"íƒœì—°", group:"ì†Œë…€ì‹œëŒ€", debut:2007 },

    { name:"ë°±í˜„", group:"EXO", debut:2012 },
    { name:"ì¹´ì´", group:"EXO", debut:2012 },
    { name:"ë””ì˜¤", group:"EXO", debut:2012 },
    { name:"ì„¸í›ˆ", group:"EXO", debut:2012 },

    { name:"íƒœìš©", group:"NCT", debut:2016 },
    { name:"ë§ˆí¬", group:"NCT", debut:2016 },
    { name:"ì¬í˜„", group:"NCT", debut:2016 },
    { name:"í•´ì°¬", group:"NCT", debut:2016 },

    { name:"ìœˆí„°", group:"ì—ìŠ¤íŒŒ", debut:2020 },
    { name:"ì¹´ë¦¬ë‚˜", group:"ì—ìŠ¤íŒŒ", debut:2020 },
    { name:"ë‹ë‹", group:"ì—ìŠ¤íŒŒ", debut:2020 },
    { name:"ì§€ì ¤", group:"ì—ìŠ¤íŒŒ", debut:2020 },

    // YG
    { name:"ì œë‹ˆ", group:"ë¸”ë™í•‘í¬", debut:2016 },
    { name:"ë¦¬ì‚¬", group:"ë¸”ë™í•‘í¬", debut:2016 },
    { name:"ë¡œì œ", group:"ë¸”ë™í•‘í¬", debut:2016 },
    { name:"ì§€ìˆ˜", group:"ë¸”ë™í•‘í¬", debut:2016 },

    { name:"ì§€í›ˆ", group:"íŠ¸ë ˆì €", debut:2020 },
    { name:"í˜„ì„", group:"íŠ¸ë ˆì €", debut:2020 },
    { name:"ì•„ì‚¬íˆ", group:"íŠ¸ë ˆì €", debut:2020 },

    // JYP
    { name:"ë‚˜ì—°", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ì •ì—°", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ëª¨ëª¨", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ì‚¬ë‚˜", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ì§€íš¨", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ë¯¸ë‚˜", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ë‹¤í˜„", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ì±„ì˜", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ì¯”ìœ„", group:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },

    { name:"ë°©ì°¬", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"ë¦¬ë…¸", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"ì°½ë¹ˆ", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"í˜„ì§„", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"í•œ", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"í•„ë¦­ìŠ¤", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"ìŠ¹ë¯¼", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"ì•„ì´ì—”", group:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },

    { name:"ì˜ˆì§€", group:"ITZY", debut:2019 },
    { name:"ë¥˜ì§„", group:"ITZY", debut:2019 },
    { name:"ë¦¬ì•„", group:"ITZY", debut:2019 },
    { name:"ì±„ë ¹", group:"ITZY", debut:2019 },
    { name:"ìœ ë‚˜", group:"ITZY", debut:2019 },

    { name:"ì„¤ìœ¤", group:"NMIXX", debut:2022 },
    { name:"í•´ì›", group:"NMIXX", debut:2022 },
    { name:"ê·œì§„", group:"NMIXX", debut:2022 },

    // ìŠ¤íƒ€ì‰½ / IVE
    { name:"ì¥ì›ì˜", group:"ì•„ì´ë¸Œ", debut:2018 },
    { name:"ì•ˆìœ ì§„", group:"ì•„ì´ë¸Œ", debut:2018 },
    { name:"ë ˆì´", group:"ì•„ì´ë¸Œ", debut:2021 },
    { name:"ë¦¬ì¦ˆ", group:"ì•„ì´ë¸Œ", debut:2021 },
    { name:"ì´ì„œ", group:"ì•„ì´ë¸Œ", debut:2021 },

    // ADOR / SOURCE
    { name:"ë¯¼ì§€", group:"ë‰´ì§„ìŠ¤", debut:2022 },
    { name:"í•˜ë‹ˆ", group:"ë‰´ì§„ìŠ¤", debut:2022 },
    { name:"ë‹¤ë‹ˆì—˜", group:"ë‰´ì§„ìŠ¤", debut:2022 },
    { name:"í•´ë¦°", group:"ë‰´ì§„ìŠ¤", debut:2022 },
    { name:"í˜œì¸", group:"ë‰´ì§„ìŠ¤", debut:2022 },

    { name:"ì‚¬ì¿ ë¼", group:"ë¥´ì„¸ë¼í•Œ", debut:2018 },
    { name:"ê¹€ì±„ì›", group:"ë¥´ì„¸ë¼í•Œ", debut:2018 },
    { name:"í—ˆìœ¤ì§„", group:"ë¥´ì„¸ë¼í•Œ", debut:2022 },
    { name:"ì¹´ì¦ˆí•˜", group:"ë¥´ì„¸ë¼í•Œ", debut:2022 },
    { name:"ì€ì±„", group:"ë¥´ì„¸ë¼í•Œ", debut:2022 },

    // 5ì„¸ëŒ€ / ì‹ ì¸
    { name:"ì„±í•œë¹ˆ", group:"ì œë¡œë² ì´ìŠ¤ì›", debut:2023 },
    { name:"ì¥í•˜ì˜¤", group:"ì œë¡œë² ì´ìŠ¤ì›", debut:2023 },
    { name:"ë¦¬í‚¤", group:"ì œë¡œë² ì´ìŠ¤ì›", debut:2023 },

    { name:"ì›ë¹ˆ", group:"ë¼ì´ì¦ˆ", debut:2023 },
    { name:"ì†Œí¬", group:"ë¼ì´ì¦ˆ", debut:2023 },

    { name:"ë¯¼ì£¼", group:"ì•„ì¼ë¦¿", debut:2024 },
    { name:"ìœ¤ì•„", group:"ì•„ì¼ë¦¿", debut:2024 },

    { name:"ë„í›ˆ", group:"TWS", debut:2024 },
    { name:"ì‹ ìœ ", group:"TWS", debut:2024 },

    // ê·¸ë£¹(ê·¸ë£¹ ì¹´í…Œê³ ë¦¬ìš©: ê·¸ë£¹ëª…ë§Œ í‘œì‹œ)
    { name:"ì„¸ë¸í‹´", debut:2015 },
    { name:"íŠ¸ì™€ì´ìŠ¤", debut:2015 },
    { name:"ë¸”ë™í•‘í¬", debut:2016 },
    { name:"ìŠ¤íŠ¸ë ˆì´ í‚¤ì¦ˆ", debut:2018 },
    { name:"ITZY", debut:2019 },
    { name:"íˆ¬ëª¨ë¡œìš°ë°”ì´íˆ¬ê²Œë”", debut:2019 },
    { name:"ì—”í•˜ì´í”ˆ", debut:2020 },
    { name:"íŠ¸ë ˆì €", debut:2020 },
    { name:"ì•„ì´ë¸Œ", debut:2021 },
    { name:"ë‰´ì§„ìŠ¤", debut:2022 },
    { name:"ë¥´ì„¸ë¼í•Œ", debut:2022 },
    { name:"ë¼ì´ì¦ˆ", debut:2023 },
    { name:"ì œë¡œë² ì´ìŠ¤ì›", debut:2023 },
    { name:"ë³´ì´ë„¥ìŠ¤íŠ¸ë„ì–´", debut:2023 },
    { name:"í‚¤ìŠ¤ì˜¤ë¸Œë¼ì´í”„", debut:2023 },
    { name:"ì•„ì¼ë¦¿", debut:2024 },
    { name:"TWS", debut:2024 },
    { name:"ë² ì´ë¹„ëª¬ìŠ¤í„°", debut:2024 }
  ];

  // ===== ìœ í‹¸ =====
  const $ = (id) => document.getElementById(id);

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]]=[a[j],a[i]];
    }
    return a;
  }
  function isLegend(idol){
    return (CURRENT_YEAR - idol.debut) >= 7; // ë ˆì „ë“œ: 7ë…„ ì´ìƒ
  }

  

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#39;");
  }
// ===== UI refs =====
  const $boot = $("boot");
  const $score = $("score");
  const $combo = $("combo");
  const $comboBox = $("comboBox");
  const $time = $("time");
  const $hint = $("hint");
  const $slots = $("slots");

  const $startOnly = $("startOnly");
  const $answerButtons = $("answerButtons");
  const $btnStart = $("btnStart");
  const $btnLegend = $("btnLegend");
  const $btnIcon = $("btnIcon");
  const $btnCopy = $("btnCopy");
  const $btnReset = $("btnReset");

  const $result = $("result");
  const $rtype = $("rtype");
  const $rdesc = $("rdesc");
  const $rmeta = $("rmeta");
  const $shareText = $("shareText");

  // ===== State =====
  let deck = [];
  let queue = [];      // í™”ë©´ 5ê°œ(ìœ„->ì•„ë˜)
  let blockEls = [];   // ê³ ì • 5ê°œ DOM (FLIP)
  let score = 0, combo = 0, bestCombo = 0;
  let timeLeft = GAME_TIME;
  let timer = null;
  let playing = false;
  let locked = false;

  let total = 0, correctCount = 0, wrongCount = 0;

  // ===== FX =====
  function comboFx(){
    $combo.classList.remove("comboPulse");
    void $combo.offsetWidth;
    $combo.classList.add("comboPulse");

    if(combo >= 5) $comboBox.classList.add("hot");
    else $comboBox.classList.remove("hot");
  }

  // ===== Render / FLIP =====
  function ensureBlocks(){
    if(blockEls.length === VISIBLE_COUNT) return;
    $slots.innerHTML = "";
    blockEls = [];
    for(let i=0;i<VISIBLE_COUNT;i++){
      const el = document.createElement("div");
      el.className = "block";
      $slots.appendChild(el);
      blockEls.push(el);
    }
  }

  function applyClasses(){
    for(let i=0;i<VISIBLE_COUNT;i++){
      const el = blockEls[i];
      el.classList.toggle("selected", i === ACTIVE_INDEX);
      el.classList.toggle("past", i > ACTIVE_INDEX);
    }
  }

  function renderQueue({enterTop=false, flip=false} = {}){
    ensureBlocks();

    const before = flip ? blockEls.map(el => el.getBoundingClientRect()) : null;

    for(let i=0;i<VISIBLE_COUNT;i++){
      const item = queue[i];
      const name = item?.name ?? "";
      const group = item?.group ?? "";
      blockEls[i].innerHTML = `<div class="bName">${escapeHtml(name)}</div>${group ? `<div class="bGroup">${escapeHtml(group)}</div>` : ""}`;
    }
    applyClasses();

    if(enterTop){
      const topEl = blockEls[0];
      topEl.classList.add("enter");
      requestAnimationFrame(() => topEl.classList.add("enterOn"));
      setTimeout(() => topEl.classList.remove("enter","enterOn"), 240);
    }

    if(!flip) return;

    const after = blockEls.map(el => el.getBoundingClientRect());
    for(let i=0;i<VISIBLE_COUNT;i++){
      const dx = before[i].left - after[i].left;
      const dy = before[i].top - after[i].top;
      if(dx === 0 && dy === 0) continue;

      const el = blockEls[i];
      const isSel = el.classList.contains("selected");
      const base = isSel ? " scale(1.06)" : "";
      el.animate(
        [
          { transform: `translate(${dx}px, ${dy}px)${base}` },
          { transform: base.trim() || "translate(0,0)" }
        ],
        { duration: 220, easing: "cubic-bezier(.2,.8,.2,1)" }
      );
    }
  }

  // ===== ê²°ê³¼ íƒ€ì… =====
  function calcResultType(acc, bestCombo){
    if (acc >= 90 && bestCombo >= 10) return { title:"ğŸ“š ì•„ì´ëŒ ì—°ëŒ€ê¸° ë§ˆìŠ¤í„°", desc:"ì—°ì°¨ ê°ê°ì´ êµê³¼ì„œê¸‰. ë°ë·” ì—°ë„ ì§€ë¬¸ë§Œ ë´ë„ ë§íˆëŠ” íƒ€ì…!" };
    if (acc >= 85) return { title:"ğŸ§  ì„¸ëŒ€ ì •ë¦¬ì™•", desc:"ë ˆì „ë“œ/ì•„ì´ì½˜ ê²½ê³„ë¥¼ ì •í™•íˆ ìºì¹˜í•´. ë•ì§ˆ ì´ë ¥ì„œê°€ ë¹›ë‚œë‹¤." };
    if (acc >= 70 && bestCombo >= 8) return { title:"âš¡ ë°˜ì‚¬ì‹ ê²½ ë•í›„", desc:"ë¹ ë¥´ê²Œ ì°ê³  ë¹ ë¥´ê²Œ ë§íŒë‹¤! ê°ê°ìœ¼ë¡œ ê²Œì„ì„ ëš«ëŠ” íƒ€ì…." };
    if (acc >= 65) return { title:"ğŸ§ ì²´ê°ì—°ì°¨ í”Œë ˆì´ì–´", desc:"ì •í™•í•˜ì§„ ì•Šì•„ë„ â€˜ëŠë‚Œâ€™ì´ ìˆë‹¤. ìµœì‹  ë¼ì¸ì—…ì— ê°•í•œ í¸!" };
    if (acc >= 50) return { title:"ğŸŒ€ í˜¼ì¢… ì„¸ëŒ€ íƒí—˜ê°€", desc:"ì„¸ëŒ€ ê²½ê³„ì—ì„œ í”ë“¤ë¦¬ëŠ” ì¤‘â€¦ í•˜ì§€ë§Œ ë°œì „ ê°€ëŠ¥ì„± 100%." };
    return { title:"ğŸ£ ë‰´ë¹„ í”„ë¡œë“€ì„œ", desc:"ì§€ê¸ˆë¶€í„°ê°€ ì‹œì‘! í•œ íŒ ë” í•˜ë©´ ì²´ê° ì—°ì°¨ê°€ í™• ì˜¬ë¼ê°ˆê±¸?" };
  }

  // ===== UI helpers =====
  function updateUI(){
    $score.textContent = score;
    $combo.textContent = combo;
    $time.textContent = timeLeft;
  }

  function showStartOnly(){
    $startOnly.style.display = "block";
    $answerButtons.style.display = "none";
    $btnReset.disabled = true;
  }
  function showAnswerButtons(){
    $startOnly.style.display = "none";
    $answerButtons.style.display = "flex";
    $btnReset.disabled = false;
  }

  function buildShareText(acc, resultType){
    return [
      "ì•„ì´ëŒ ë ˆì¼ 5ë¸”ëŸ­ ê²°ê³¼",
      `íƒ€ì…: ${resultType.title}`,
      `ì ìˆ˜: ${score}ì  / ì •í™•ë„: ${acc}%`,
      `ì •ë‹µ ${correctCount} Â· ì˜¤ë‹µ ${wrongCount} Â· ìµœê³ ì½¤ë³´ ${bestCombo}`,
      "",
      "ë„ˆë„ í•´ë´ ğŸ‘‰ (ì—¬ê¸°ì— ë§í¬ ë„£ê¸°)"
    ].join("\n");
  }

  // ===== ê²Œì„ íë¦„ =====
  function refillDeckIfNeeded(){
    if(deck.length === 0) deck = shuffle(IDOLS);
  }
  function draw(){
    refillDeckIfNeeded();
    return deck.pop();
  }

  function startGame(){
    score = 0; combo = 0; bestCombo = 0;
    timeLeft = GAME_TIME;
    total = 0; correctCount = 0; wrongCount = 0;

    deck = shuffle(IDOLS);
    queue = [];
    playing = true;
    locked = false;

    $result.style.display = "none";
    $btnCopy.disabled = true;
    showAnswerButtons();

    for(let i=0;i<VISIBLE_COUNT;i++) queue.push(draw());
    renderQueue();
    $hint.textContent = "3ë²ˆì§¸(ì„ íƒë¨) ë¸”ëŸ­ì´ ë ˆì „ë“œ/ì•„ì´ì½˜ì¸ì§€ ë§í˜€ë³´ì„¸ìš”!";
    updateUI();
    comboFx();

    clearInterval(timer);
    timer = setInterval(() => {
      timeLeft -= 1;
      updateUI();
      if(timeLeft <= 0) endGame();
    }, 1000);
  }

  function endGame(){
    playing = false;
    locked = false;
    clearInterval(timer);
    timer = null;

    showStartOnly();
    $btnStart.textContent = "RESTART";

    const acc = total ? Math.round((correctCount/total)*100) : 0;
    const t = calcResultType(acc, bestCombo);

    $rtype.textContent = t.title;
    $rdesc.textContent = t.desc;
    $rmeta.textContent = `ì •í™•ë„ ${acc}% Â· ì •ë‹µ ${correctCount}/${total} Â· ìµœê³ ì½¤ë³´ ${bestCombo} Â· ì ìˆ˜ ${score}ì `;

    const share = buildShareText(acc, t);
    $shareText.textContent = share;

    $result.style.display = "block";
    $btnCopy.disabled = false;

    $hint.textContent = "ê²Œì„ ì¢…ë£Œ! ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš” ğŸ‘‡";
  }

  function answer(choiceLegend){
    if(!playing || locked) return;
    locked = true;

    const idol = queue[ACTIVE_INDEX];
    total += 1;

    const correct = (choiceLegend === isLegend(idol));
    if(correct){
      correctCount += 1;
      combo += 1;
      bestCombo = Math.max(bestCombo, combo);

      const add = 10 + (combo >= 5 ? 10 : 0);
      score += add;

      comboFx();
      $hint.textContent = `ì •ë‹µ! +${add} (${idol.name}, ${idol.debut})`;
      if(combo === 5) $hint.textContent = `ğŸ”¥ 5 COMBO! +${add} (${idol.name}, ${idol.debut})`;
      if(combo === 10) $hint.textContent = `âš¡ 10 COMBO! +${add} (${idol.name}, ${idol.debut})`;
    }else{
      wrongCount += 1;
      combo = 0;
      comboFx();
      score = Math.max(0, score - 5);
      $hint.textContent = `ì˜¤ë‹µ! -5 (${idol.name}, ${idol.debut})`;
    }

    updateUI();

    // ì»¨ë² ì´ì–´: í•œ ì¹¸ ì•„ë˜ë¡œ ìŠ¤ë¥´ë¥µ
    $slots.style.transition = "transform .22s ease-in-out";
    $slots.style.transform = `translateY(${getComputedStyle(document.documentElement).getPropertyValue("--shift").trim() || "68px"})`;

    setTimeout(() => {
      $slots.style.transition = "none";
      $slots.style.transform = "translateY(0)";

      queue.pop();
      queue.unshift(draw());

      renderQueue({enterTop:true, flip:true});
      locked = false;
    }, 230);
  }

  function hardReset(){
    playing = false;
    locked = false;
    clearInterval(timer);
    timer = null;

    score = 0; combo = 0; bestCombo = 0;
    timeLeft = GAME_TIME;
    total = 0; correctCount = 0; wrongCount = 0;

    deck = shuffle(IDOLS);
    queue = [];
    for(let i=0;i<VISIBLE_COUNT;i++) queue.push(draw());

    renderQueue();
    updateUI();
    comboFx();

    $hint.textContent = "STARTë¥¼ ëˆŒëŸ¬ ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”!";
    $result.style.display = "none";
    $btnCopy.disabled = true;

    showStartOnly();
    $btnStart.textContent = "START";
  }

  // ===== ëª¨ë°”ì¼ í„°ì¹˜/ì—°íƒ€ ìµœì í™” =====
  function bindFastTap(btn, fn){
    btn.addEventListener("pointerdown", (e) => {
      e.preventDefault();
      fn();
    }, {passive:false});
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      fn();
    });
  }

  // ===== ì´ë²¤íŠ¸ =====
  bindFastTap($btnLegend, () => answer(true));
  bindFastTap($btnIcon,   () => answer(false));
  bindFastTap($btnStart,  () => startGame());
  bindFastTap($btnReset,  () => hardReset());

  bindFastTap($btnCopy, async () => {
    const text = $shareText.textContent || "";
    try{
      await navigator.clipboard.writeText(text);
      $hint.textContent = "ê³µìœ  ë¬¸êµ¬ ë³µì‚¬ ì™„ë£Œ! âœ…";
    }catch(e){
      $hint.textContent = "ë³µì‚¬ ì‹¤íŒ¨ ğŸ˜­ ê³µìœ ë¬¸êµ¬ë¥¼ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ì¤˜.";
    }
  });

  window.addEventListener("keydown", (e) => {
    if(!playing) return;
    if(e.key === "ArrowLeft") answer(true);
    if(e.key === "ArrowRight") answer(false);
  });

  // ===== ì´ˆê¸° ë¡œë”© =====
  window.addEventListener("load", () => {
    setTimeout(() => $boot.classList.add("off"), 380);
    hardReset();
  });
</script>
</body>
</html>
